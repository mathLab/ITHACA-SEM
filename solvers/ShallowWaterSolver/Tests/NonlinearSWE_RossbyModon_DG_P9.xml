<?xml version="1.0" encoding="utf-8"?>

<NEKTAR xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="http://www.nektar.info/schema/nektar.xsd">

    <GEOMETRY DIM="2" SPACE="2">

        <VERTEX>
            <V ID="0">  -24.0   -8.0    0.0 </V>
            <V ID="1">  -20.0   -8.0    0.0 </V>
            <V ID="2">  -16.0   -8.0    0.0 </V>
            <V ID="3">  -12.0   -8.0    0.0 </V>
            <V ID="4">   -8.0   -8.0    0.0 </V>
            <V ID="5">   -4.0   -8.0    0.0 </V>
            <V ID="6">    0.0   -8.0    0.0 </V>
            <V ID="7">    4.0   -8.0    0.0 </V>
            <V ID="8">    8.0   -8.0    0.0 </V>
            <V ID="9">   12.0   -8.0    0.0 </V>
            <V ID="10">  16.0   -8.0    0.0 </V>
            <V ID="11">  20.0   -8.0    0.0 </V>
            <V ID="12">  24.0   -8.0    0.0 </V>
            <V ID="13"> -24.0   -4.0    0.0 </V>
            <V ID="14"> -20.0   -4.0    0.0 </V>
            <V ID="15"> -16.0   -4.0    0.0 </V>
            <V ID="16"> -12.0   -4.0    0.0 </V>
            <V ID="17">  -8.0   -4.0    0.0 </V>
            <V ID="18">  -4.0   -4.0    0.0 </V>
            <V ID="19">   0.0   -4.0    0.0 </V>
            <V ID="20">   4.0   -4.0    0.0 </V>
            <V ID="21">   8.0   -4.0    0.0 </V>
            <V ID="22">  12.0   -4.0    0.0 </V>
            <V ID="23">  16.0   -4.0    0.0 </V>
            <V ID="24">  20.0   -4.0    0.0 </V>
            <V ID="25">  24.0   -4.0    0.0 </V>
            <V ID="26"> -24.0    0.0    0.0 </V>
            <V ID="27"> -20.0    0.0    0.0 </V>
            <V ID="28"> -16.0    0.0    0.0 </V>
            <V ID="29"> -12.0    0.0    0.0 </V>
            <V ID="30">  -8.0    0.0    0.0 </V>
            <V ID="31">  -4.0    0.0    0.0 </V>
            <V ID="32">   0.0    0.0    0.0 </V>
            <V ID="33">   4.0    0.0    0.0 </V>
            <V ID="34">   8.0    0.0    0.0 </V>
            <V ID="35">  12.0    0.0    0.0 </V>
            <V ID="36">  16.0    0.0    0.0 </V>
            <V ID="37">  20.0    0.0    0.0 </V>
            <V ID="38">  24.0    0.0    0.0 </V>
            <V ID="39"> -24.0    4.0    0.0 </V>
            <V ID="40"> -20.0    4.0    0.0 </V>
            <V ID="41"> -16.0    4.0    0.0 </V>
            <V ID="42"> -12.0    4.0    0.0 </V>
            <V ID="43">  -8.0    4.0    0.0 </V>
            <V ID="44">  -4.0    4.0    0.0 </V>
            <V ID="45">   0.0    4.0    0.0 </V>
            <V ID="46">   4.0    4.0    0.0 </V>
            <V ID="47">   8.0    4.0    0.0 </V>
            <V ID="48">  12.0    4.0    0.0 </V>
            <V ID="49">  16.0    4.0    0.0 </V>
            <V ID="50">  20.0    4.0    0.0 </V>
            <V ID="51">  24.0    4.0    0.0 </V>
            <V ID="52"> -24.0    8.0    0.0 </V>
            <V ID="53"> -20.0    8.0    0.0 </V>
            <V ID="54"> -16.0    8.0    0.0 </V>
            <V ID="55"> -12.0    8.0    0.0 </V>
            <V ID="56">  -8.0    8.0    0.0 </V>
            <V ID="57">  -4.0    8.0    0.0 </V>
            <V ID="58">   0.0    8.0    0.0 </V>
            <V ID="59">   4.0    8.0    0.0 </V>
            <V ID="60">   8.0    8.0    0.0 </V>
            <V ID="61">  12.0    8.0    0.0 </V>
            <V ID="62">  16.0    8.0    0.0 </V>
            <V ID="63">  20.0    8.0    0.0 </V>
            <V ID="64">  24.0    8.0    0.0 </V>
        </VERTEX>

        <EDGE>
            <E ID="0">    0  1 </E>
            <E ID="1">    1  2 </E>
            <E ID="2">    2  3 </E>
            <E ID="3">    3  4 </E>
            <E ID="4">    4  5 </E>
            <E ID="5">    5  6 </E>
            <E ID="6">    6  7 </E>
            <E ID="7">    7  8 </E>
            <E ID="8">    8  9 </E>
            <E ID="9">    9 10 </E>
            <E ID="10">  10 11 </E>
            <E ID="11">  11 12 </E>
            <E ID="12">  13  0 </E>
            <E ID="13">   1 14 </E>
            <E ID="14">   2 15 </E>
            <E ID="15">   3 16 </E>
            <E ID="16">   4 17 </E>
            <E ID="17">   5 18 </E>
            <E ID="18">   6 19 </E>
            <E ID="19">   7 20 </E>
            <E ID="20">   8 21 </E>
            <E ID="21">   9 22 </E>
            <E ID="22">  10 23 </E>
            <E ID="23">  11 24 </E>
            <E ID="24">  12 25 </E>
            <E ID="25">  26 13 </E>
            <E ID="26">  14 27 </E>
            <E ID="27">  15 28 </E>
            <E ID="28">  16 29 </E>
            <E ID="29">  17 30 </E>
            <E ID="30">  18 31 </E>
            <E ID="31">  19 32 </E>
            <E ID="32">  20 33 </E>
            <E ID="33">  21 34 </E>
            <E ID="34">  22 35 </E>
            <E ID="35">  23 36 </E>
            <E ID="36">  24 37 </E>
            <E ID="37">  25 38 </E>
            <E ID="38">  39 26 </E>
            <E ID="39">  27 40 </E>
            <E ID="40">  28 41 </E>
            <E ID="41">  29 42 </E>
            <E ID="42">  30 43 </E>
            <E ID="43">  31 44 </E>
            <E ID="44">  32 45 </E>
            <E ID="45">  33 46 </E>
            <E ID="46">  34 47 </E>
            <E ID="47">  35 48 </E>
            <E ID="48">  36 49 </E>
            <E ID="49">  37 50 </E>
            <E ID="50">  38 51 </E>
            <E ID="51">  52 39 </E>
            <E ID="52">  40 53 </E>
            <E ID="53">  41 54 </E>
            <E ID="54">  42 55 </E>
            <E ID="55">  43 56 </E>
            <E ID="56">  44 57 </E>
            <E ID="57">  45 58 </E>
            <E ID="58">  46 59 </E>
            <E ID="59">  47 60 </E>
            <E ID="60">  48 61 </E>
            <E ID="61">  49 62 </E>
            <E ID="62">  50 63 </E>
            <E ID="63">  51 64 </E>
            <E ID="64">  13 14 </E>
            <E ID="65">  14 15 </E>
            <E ID="66">  15 16 </E>
            <E ID="67">  16 17 </E>
            <E ID="68">  17 18 </E>
            <E ID="69">  18 19 </E>
            <E ID="70">  19 20 </E>
            <E ID="71">  20 21 </E>
            <E ID="72">  21 22 </E>
            <E ID="73">  22 23 </E>
            <E ID="74">  23 24 </E>
            <E ID="75">  24 25 </E>
            <E ID="76">  26 27 </E>
            <E ID="77">  27 28 </E>
            <E ID="78">  28 29 </E>
            <E ID="79">  29 30 </E>
            <E ID="80">  30 31 </E>
            <E ID="81">  31 32 </E>
            <E ID="82">  32 33 </E>
            <E ID="83">  33 34 </E>
            <E ID="84">  34 35 </E>
            <E ID="85">  35 36 </E>
            <E ID="86">  36 37 </E>
            <E ID="87">  37 38 </E>
            <E ID="88">  39 40 </E>
            <E ID="89">  40 41 </E>
            <E ID="90">  41 42 </E>
            <E ID="91">  42 43 </E>
            <E ID="92">  43 44 </E>
            <E ID="93">  44 45 </E>
            <E ID="94">  45 46 </E>
            <E ID="95">  46 47 </E>
            <E ID="96">  47 48 </E>
            <E ID="97">  48 49 </E>
            <E ID="98">  49 50 </E>
            <E ID="99">  50 51 </E>
            <E ID="100"> 64 63 </E>
            <E ID="101"> 63 62 </E>
            <E ID="102"> 62 61 </E>
            <E ID="103"> 61 60 </E>
            <E ID="104"> 60 59 </E>
            <E ID="105"> 59 58 </E>
            <E ID="106"> 58 57 </E>
            <E ID="107"> 57 56 </E>
            <E ID="108"> 56 55 </E>
            <E ID="109"> 55 54 </E>
            <E ID="110"> 54 53 </E>
            <E ID="111"> 53 52 </E>
        </EDGE>

        <ELEMENT>
            <Q ID="0">   0 13 64 12 </Q>
            <Q ID="1">   1 14 65 13 </Q>
            <Q ID="2">   2 15 66 14 </Q>
            <Q ID="3">   3 16 67 15 </Q>
            <Q ID="4">   4 17 68 16 </Q>
            <Q ID="5">   5 18 69 17 </Q>
            <Q ID="6">   6 19 70 18 </Q>
            <Q ID="7">   7 20 71 19 </Q>
            <Q ID="8">   8 21 72 20 </Q>
            <Q ID="9">   9 22 73 21 </Q>
            <Q ID="10"> 10 23 74 22 </Q>
            <Q ID="11"> 11 24 75 23 </Q>
            <Q ID="12">  64 26 76 25 </Q>
            <Q ID="13">  65 27 77 26 </Q>
            <Q ID="14">  66 28 78 27 </Q>
            <Q ID="15">  67 29 79 28 </Q>
            <Q ID="16">  68 30 80 29 </Q>
            <Q ID="17">  69 31 81 30 </Q>
            <Q ID="18">  70 32 82 31 </Q>
            <Q ID="19">  71 33 83 32 </Q>
            <Q ID="20">  72 34 84 33 </Q>
            <Q ID="21">  73 35 85 34 </Q>
            <Q ID="22">  74 36 86 35 </Q>
            <Q ID="23">  75 37 87 36 </Q>
            <Q ID="24">  76 39 88 38 </Q>
            <Q ID="25">  77 40 89 39 </Q>
            <Q ID="26">  78 41 90 40 </Q>
            <Q ID="27">  79 42 91 41 </Q>
            <Q ID="28">  80 43 92 42 </Q>
            <Q ID="29">  81 44 93 43 </Q>
            <Q ID="30">  82 45 94 44 </Q>
            <Q ID="31">  83 46 95 45 </Q>
            <Q ID="32">  84 47 96 46 </Q>
            <Q ID="33">  85 48 97 47 </Q>
            <Q ID="34">  86 49 98 48 </Q>
            <Q ID="35">  87 50 99 49 </Q>
            <Q ID="36">  88 52 111 51 </Q>
            <Q ID="37">  89 53 110 52 </Q>
            <Q ID="38">  90 54 109 53 </Q>
            <Q ID="39">  91 55 108 54 </Q>
            <Q ID="40">  92 56 107 55 </Q>
            <Q ID="41">  93 57 106 56 </Q>
            <Q ID="42">  94 58 105 57 </Q>
            <Q ID="43">  95 59 104 58 </Q>
            <Q ID="44">  96 60 103 59 </Q>
            <Q ID="45">  97 61 102 60 </Q>
            <Q ID="46">  98 62 101 61 </Q>
            <Q ID="47">  99 63 100 62 </Q>
        </ELEMENT>

        <COMPOSITE>
            <C ID="0"> Q[0-47] </C>
            <C ID="1"> E[0,1,2,3,4,5,6,7,8,9,10,11] </C>
            <C ID="2"> E[24,37,50,63] </C>
            <C ID="3"> E[100,101,102,103,104,105,106,107,108,109,110,111] </C>
            <C ID="4"> E[12,25,38,51] </C>
        </COMPOSITE>

        <DOMAIN> C[0] </DOMAIN>

    </GEOMETRY>

    <EXPANSIONS>
        <E COMPOSITE="C[0]" NUMMODES="9" FIELDS="h,hu,hv" TYPE="MODIFIED" />
    </EXPANSIONS>

    <CONDITIONS>

        <SOLVERINFO>
            <I PROPERTY="EQType" VALUE="NonlinearSWE" />
            <I PROPERTY="Projection" VALUE="DisContinuous" />
            <I PROPERTY="TimeIntegrationMethod" VALUE="ClassicalRungeKutta4" />
            <I PROPERTY="UpwindType" VALUE="HLLC" />
        </SOLVERINFO>


        <PARAMETERS>
            <P> TimeStep       = 0.04             </P>
            <P> NumSteps       = 100             </P>
            <P> FinTime        = TimeStep*NumSteps </P>
            <P> IO_CheckSteps  = 1000               </P>
            <P> IO_InfoSteps   = 100              </P>
            <P> Gravity        = 1.0               </P>
        </PARAMETERS>

        <VARIABLES>
            <V ID="0"> h  </V>
            <V ID="1"> hu </V>
            <V ID="2"> hv </V>
        </VARIABLES>

        <BOUNDARYREGIONS>
            <B ID="0"> C[1,2,3,4]  </B>
        </BOUNDARYREGIONS>

        <BOUNDARYCONDITIONS>
            <REGION REF="0">
                <D VAR="h" USERDEFINEDTYPE="Wall" VALUE="0" />
                <D VAR="hu" USERDEFINEDTYPE="Wall" VALUE="0" />
                <D VAR="hv" USERDEFINEDTYPE="Wall" VALUE="0" />
            </REGION>
        </BOUNDARYCONDITIONS>

        <FUNCTION NAME="Coriolis">
            <E VAR="f" VALUE="0+1*y" />
        </FUNCTION>
        <FUNCTION NAME="WaterDepth">
            <E VAR="d" VALUE="1" />
        </FUNCTION>

        <FUNCTION NAME="InitialConditions">
            <E VAR="h"
                VALUE="1+(0.771*0.395*0.395*(1.0/cosh(0.395*x))*(1.0/cosh(0.395*x)))*(3.0+6.0*y*y)/(4.0)*exp(-0.5*y*y)" />
            <E VAR="hu"
                VALUE=" ( (0.771*0.395*0.395*(1.0/cosh(0.395*x))*(1.0/cosh(0.395*x)))*(-9.0+6.0*y*y)/(4.0)*exp(-0.5*y*y) ) *
                (1+(0.771*0.395*0.395*(1.0/cosh(0.395*x))*(1.0/cosh(0.395*x)))*(3.0+6.0*y*y)/(4.0)*exp(-0.5*y*y))" />
            <E VAR="hv"
                VALUE=" ( (-2.0*0.395*tanh(0.395*x))*(0.771*0.395*0.395*(1.0/cosh(0.395*x))*(1.0/cosh(0.395*x)))*(2.0*y)*exp(-0.5*y*y)) *
                (1+(0.771*0.395*0.395*(1.0/cosh(0.395*x))*(1.0/cosh(0.395*x)))*(3.0+6.0*y*y)/(4.0)*exp(-0.5*y*y))" />
        </FUNCTION>

        <FUNCTION NAME="ExactSolution">
            <E VAR="h" VALUE="0" />
            <E VAR="hu" VALUE=" 0" />
            <E VAR="hv" VALUE=" 0" />
        </FUNCTION>

    </CONDITIONS>

</NEKTAR>

<?xml version="1.0" encoding="utf-8"?>
<NEKTAR>
  <GEOMETRY DIM="2" SPACE="2">
    <VERTEX>
      <V ID="0">-1.000e+00 -1.000e+00 0.000e+00</V>
      <V ID="1">-7.500e-01 -1.000e+00 0.000e+00</V>
      <V ID="2">-7.500e-01 -7.500e-01 0.000e+00</V>
      <V ID="3">-1.000e+00 -7.500e-01 0.000e+00</V>
      <V ID="4">-7.500e-01 -5.000e-01 0.000e+00</V>
      <V ID="5">-1.000e+00 -5.000e-01 0.000e+00</V>
      <V ID="6">-7.500e-01 -2.500e-01 0.000e+00</V>
      <V ID="7">-1.000e+00 -2.500e-01 0.000e+00</V>
      <V ID="8">-7.500e-01 0.000e+00 0.000e+00</V>
      <V ID="9">-1.000e+00 0.000e+00 0.000e+00</V>
      <V ID="10">-7.500e-01 2.500e-01 0.000e+00</V>
      <V ID="11">-1.000e+00 2.500e-01 0.000e+00</V>
      <V ID="12">-7.500e-01 5.000e-01 0.000e+00</V>
      <V ID="13">-1.000e+00 5.000e-01 0.000e+00</V>
      <V ID="14">-7.500e-01 7.500e-01 0.000e+00</V>
      <V ID="15">-1.000e+00 7.500e-01 0.000e+00</V>
      <V ID="16">-7.500e-01 1.000e+00 0.000e+00</V>
      <V ID="17">-1.000e+00 1.000e+00 0.000e+00</V>
      <V ID="18">-5.000e-01 -1.000e+00 0.000e+00</V>
      <V ID="19">-5.000e-01 -7.500e-01 0.000e+00</V>
      <V ID="20">-5.000e-01 -5.000e-01 0.000e+00</V>
      <V ID="21">-5.000e-01 -2.500e-01 0.000e+00</V>
      <V ID="22">-5.000e-01 0.000e+00 0.000e+00</V>
      <V ID="23">-5.000e-01 2.500e-01 0.000e+00</V>
      <V ID="24">-5.000e-01 5.000e-01 0.000e+00</V>
      <V ID="25">-5.000e-01 7.500e-01 0.000e+00</V>
      <V ID="26">-5.000e-01 1.000e+00 0.000e+00</V>
      <V ID="27">-2.500e-01 -1.000e+00 0.000e+00</V>
      <V ID="28">-2.500e-01 -7.500e-01 0.000e+00</V>
      <V ID="29">-2.500e-01 -5.000e-01 0.000e+00</V>
      <V ID="30">-2.500e-01 -2.500e-01 0.000e+00</V>
      <V ID="31">-2.500e-01 0.000e+00 0.000e+00</V>
      <V ID="32">-2.500e-01 2.500e-01 0.000e+00</V>
      <V ID="33">-2.500e-01 5.000e-01 0.000e+00</V>
      <V ID="34">-2.500e-01 7.500e-01 0.000e+00</V>
      <V ID="35">-2.500e-01 1.000e+00 0.000e+00</V>
      <V ID="36">0.000e+00 -1.000e+00 0.000e+00</V>
      <V ID="37">0.000e+00 -7.500e-01 0.000e+00</V>
      <V ID="38">0.000e+00 -5.000e-01 0.000e+00</V>
      <V ID="39">0.000e+00 -2.500e-01 0.000e+00</V>
      <V ID="40">0.000e+00 0.000e+00 0.000e+00</V>
      <V ID="41">0.000e+00 2.500e-01 0.000e+00</V>
      <V ID="42">0.000e+00 5.000e-01 0.000e+00</V>
      <V ID="43">0.000e+00 7.500e-01 0.000e+00</V>
      <V ID="44">0.000e+00 1.000e+00 0.000e+00</V>
      <V ID="45">2.500e-01 -1.000e+00 0.000e+00</V>
      <V ID="46">2.500e-01 -7.500e-01 0.000e+00</V>
      <V ID="47">2.500e-01 -5.000e-01 0.000e+00</V>
      <V ID="48">2.500e-01 -2.500e-01 0.000e+00</V>
      <V ID="49">2.500e-01 0.000e+00 0.000e+00</V>
      <V ID="50">2.500e-01 2.500e-01 0.000e+00</V>
      <V ID="51">2.500e-01 5.000e-01 0.000e+00</V>
      <V ID="52">2.500e-01 7.500e-01 0.000e+00</V>
      <V ID="53">2.500e-01 1.000e+00 0.000e+00</V>
      <V ID="54">5.000e-01 -1.000e+00 0.000e+00</V>
      <V ID="55">5.000e-01 -7.500e-01 0.000e+00</V>
      <V ID="56">5.000e-01 -5.000e-01 0.000e+00</V>
      <V ID="57">5.000e-01 -2.500e-01 0.000e+00</V>
      <V ID="58">5.000e-01 0.000e+00 0.000e+00</V>
      <V ID="59">5.000e-01 2.500e-01 0.000e+00</V>
      <V ID="60">5.000e-01 5.000e-01 0.000e+00</V>
      <V ID="61">5.000e-01 7.500e-01 0.000e+00</V>
      <V ID="62">5.000e-01 1.000e+00 0.000e+00</V>
      <V ID="63">7.500e-01 -1.000e+00 0.000e+00</V>
      <V ID="64">7.500e-01 -7.500e-01 0.000e+00</V>
      <V ID="65">7.500e-01 -5.000e-01 0.000e+00</V>
      <V ID="66">7.500e-01 -2.500e-01 0.000e+00</V>
      <V ID="67">7.500e-01 0.000e+00 0.000e+00</V>
      <V ID="68">7.500e-01 2.500e-01 0.000e+00</V>
      <V ID="69">7.500e-01 5.000e-01 0.000e+00</V>
      <V ID="70">7.500e-01 7.500e-01 0.000e+00</V>
      <V ID="71">7.500e-01 1.000e+00 0.000e+00</V>
      <V ID="72">1.000e+00 -1.000e+00 0.000e+00</V>
      <V ID="73">1.000e+00 -7.500e-01 0.000e+00</V>
      <V ID="74">1.000e+00 -5.000e-01 0.000e+00</V>
      <V ID="75">1.000e+00 -2.500e-01 0.000e+00</V>
      <V ID="76">1.000e+00 0.000e+00 0.000e+00</V>
      <V ID="77">1.000e+00 2.500e-01 0.000e+00</V>
      <V ID="78">1.000e+00 5.000e-01 0.000e+00</V>
      <V ID="79">1.000e+00 7.500e-01 0.000e+00</V>
      <V ID="80">1.000e+00 1.000e+00 0.000e+00</V>
    </VERTEX>
    <EDGE>
      <E ID="0">    0  1   </E>
      <E ID="1">    1  2   </E>
      <E ID="2">    2  3   </E>
      <E ID="3">    3  0   </E>
      <E ID="4">    2  4   </E>
      <E ID="5">    4  5   </E>
      <E ID="6">    5  3   </E>
      <E ID="7">    4  6   </E>
      <E ID="8">    6  7   </E>
      <E ID="9">    7  5   </E>
      <E ID="10">    6  8   </E>
      <E ID="11">    8  9   </E>
      <E ID="12">    9  7   </E>
      <E ID="13">    8  10   </E>
      <E ID="14">   10  11   </E>
      <E ID="15">   11  9   </E>
      <E ID="16">   10  12   </E>
      <E ID="17">   12  13   </E>
      <E ID="18">   13  11   </E>
      <E ID="19">   12  14   </E>
      <E ID="20">   14  15   </E>
      <E ID="21">   15  13   </E>
      <E ID="22">   14  16   </E>
      <E ID="23">   16  17   </E>
      <E ID="24">   17  15   </E>
      <E ID="25">    1  18   </E>
      <E ID="26">   18  19   </E>
      <E ID="27">   19  2   </E>
      <E ID="28">   19  20   </E>
      <E ID="29">   20  4   </E>
      <E ID="30">   20  21   </E>
      <E ID="31">   21  6   </E>
      <E ID="32">   21  22   </E>
      <E ID="33">   22  8   </E>
      <E ID="34">   22  23   </E>
      <E ID="35">   23  10   </E>
      <E ID="36">   23  24   </E>
      <E ID="37">   24  12   </E>
      <E ID="38">   24  25   </E>
      <E ID="39">   25  14   </E>
      <E ID="40">   25  26   </E>
      <E ID="41">   26  16   </E>
      <E ID="42">   18  27   </E>
      <E ID="43">   27  28   </E>
      <E ID="44">   28  19   </E>
      <E ID="45">   28  29   </E>
      <E ID="46">   29  20   </E>
      <E ID="47">   29  30   </E>
      <E ID="48">   30  21   </E>
      <E ID="49">   30  31   </E>
      <E ID="50">   31  22   </E>
      <E ID="51">   31  32   </E>
      <E ID="52">   32  23   </E>
      <E ID="53">   32  33   </E>
      <E ID="54">   33  24   </E>
      <E ID="55">   33  34   </E>
      <E ID="56">   34  25   </E>
      <E ID="57">   34  35   </E>
      <E ID="58">   35  26   </E>
      <E ID="59">   27  36   </E>
      <E ID="60">   36  37   </E>
      <E ID="61">   37  28   </E>
      <E ID="62">   37  38   </E>
      <E ID="63">   38  29   </E>
      <E ID="64">   38  39   </E>
      <E ID="65">   39  30   </E>
      <E ID="66">   39  40   </E>
      <E ID="67">   40  31   </E>
      <E ID="68">   40  41   </E>
      <E ID="69">   41  32   </E>
      <E ID="70">   41  42   </E>
      <E ID="71">   42  33   </E>
      <E ID="72">   42  43   </E>
      <E ID="73">   43  34   </E>
      <E ID="74">   43  44   </E>
      <E ID="75">   44  35   </E>
      <E ID="76">   36  45   </E>
      <E ID="77">   45  46   </E>
      <E ID="78">   46  37   </E>
      <E ID="79">   46  47   </E>
      <E ID="80">   47  38   </E>
      <E ID="81">   47  48   </E>
      <E ID="82">   48  39   </E>
      <E ID="83">   48  49   </E>
      <E ID="84">   49  40   </E>
      <E ID="85">   49  50   </E>
      <E ID="86">   50  41   </E>
      <E ID="87">   50  51   </E>
      <E ID="88">   51  42   </E>
      <E ID="89">   51  52   </E>
      <E ID="90">   52  43   </E>
      <E ID="91">   52  53   </E>
      <E ID="92">   53  44   </E>
      <E ID="93">   45  54   </E>
      <E ID="94">   54  55   </E>
      <E ID="95">   55  46   </E>
      <E ID="96">   55  56   </E>
      <E ID="97">   56  47   </E>
      <E ID="98">   56  57   </E>
      <E ID="99">   57  48   </E>
      <E ID="100">   57  58   </E>
      <E ID="101">   58  49   </E>
      <E ID="102">   58  59   </E>
      <E ID="103">   59  50   </E>
      <E ID="104">   59  60   </E>
      <E ID="105">   60  51   </E>
      <E ID="106">   60  61   </E>
      <E ID="107">   61  52   </E>
      <E ID="108">   61  62   </E>
      <E ID="109">   62  53   </E>
      <E ID="110">   54  63   </E>
      <E ID="111">   63  64   </E>
      <E ID="112">   64  55   </E>
      <E ID="113">   64  65   </E>
      <E ID="114">   65  56   </E>
      <E ID="115">   65  66   </E>
      <E ID="116">   66  57   </E>
      <E ID="117">   66  67   </E>
      <E ID="118">   67  58   </E>
      <E ID="119">   67  68   </E>
      <E ID="120">   68  59   </E>
      <E ID="121">   68  69   </E>
      <E ID="122">   69  60   </E>
      <E ID="123">   69  70   </E>
      <E ID="124">   70  61   </E>
      <E ID="125">   70  71   </E>
      <E ID="126">   71  62   </E>
      <E ID="127">   63  72   </E>
      <E ID="128">   72  73   </E>
      <E ID="129">   73  64   </E>
      <E ID="130">   73  74   </E>
      <E ID="131">   74  65   </E>
      <E ID="132">   74  75   </E>
      <E ID="133">   75  66   </E>
      <E ID="134">   75  76   </E>
      <E ID="135">   76  67   </E>
      <E ID="136">   76  77   </E>
      <E ID="137">   77  68   </E>
      <E ID="138">   77  78   </E>
      <E ID="139">   78  69   </E>
      <E ID="140">   78  79   </E>
      <E ID="141">   79  70   </E>
      <E ID="142">   79  80   </E>
      <E ID="143">   80  71   </E>
    </EDGE>
    <ELEMENT>
      <Q ID="0">    0     1     2     3 </Q>
      <Q ID="1">    2     4     5     6 </Q>
      <Q ID="2">    5     7     8     9 </Q>
      <Q ID="3">    8    10    11    12 </Q>
      <Q ID="4">   11    13    14    15 </Q>
      <Q ID="5">   14    16    17    18 </Q>
      <Q ID="6">   17    19    20    21 </Q>
      <Q ID="7">   20    22    23    24 </Q>
      <Q ID="8">   25    26    27     1 </Q>
      <Q ID="9">   27    28    29     4 </Q>
      <Q ID="10">   29    30    31     7 </Q>
      <Q ID="11">   31    32    33    10 </Q>
      <Q ID="12">   33    34    35    13 </Q>
      <Q ID="13">   35    36    37    16 </Q>
      <Q ID="14">   37    38    39    19 </Q>
      <Q ID="15">   39    40    41    22 </Q>
      <Q ID="16">   42    43    44    26 </Q>
      <Q ID="17">   44    45    46    28 </Q>
      <Q ID="18">   46    47    48    30 </Q>
      <Q ID="19">   48    49    50    32 </Q>
      <Q ID="20">   50    51    52    34 </Q>
      <Q ID="21">   52    53    54    36 </Q>
      <Q ID="22">   54    55    56    38 </Q>
      <Q ID="23">   56    57    58    40 </Q>
      <Q ID="24">   59    60    61    43 </Q>
      <Q ID="25">   61    62    63    45 </Q>
      <Q ID="26">   63    64    65    47 </Q>
      <Q ID="27">   65    66    67    49 </Q>
      <Q ID="28">   67    68    69    51 </Q>
      <Q ID="29">   69    70    71    53 </Q>
      <Q ID="30">   71    72    73    55 </Q>
      <Q ID="31">   73    74    75    57 </Q>
      <Q ID="32">   76    77    78    60 </Q>
      <Q ID="33">   78    79    80    62 </Q>
      <Q ID="34">   80    81    82    64 </Q>
      <Q ID="35">   82    83    84    66 </Q>
      <Q ID="36">   84    85    86    68 </Q>
      <Q ID="37">   86    87    88    70 </Q>
      <Q ID="38">   88    89    90    72 </Q>
      <Q ID="39">   90    91    92    74 </Q>
      <Q ID="40">   93    94    95    77 </Q>
      <Q ID="41">   95    96    97    79 </Q>
      <Q ID="42">   97    98    99    81 </Q>
      <Q ID="43">   99   100   101    83 </Q>
      <Q ID="44">  101   102   103    85 </Q>
      <Q ID="45">  103   104   105    87 </Q>
      <Q ID="46">  105   106   107    89 </Q>
      <Q ID="47">  107   108   109    91 </Q>
      <Q ID="48">  110   111   112    94 </Q>
      <Q ID="49">  112   113   114    96 </Q>
      <Q ID="50">  114   115   116    98 </Q>
      <Q ID="51">  116   117   118   100 </Q>
      <Q ID="52">  118   119   120   102 </Q>
      <Q ID="53">  120   121   122   104 </Q>
      <Q ID="54">  122   123   124   106 </Q>
      <Q ID="55">  124   125   126   108 </Q>
      <Q ID="56">  127   128   129   111 </Q>
      <Q ID="57">  129   130   131   113 </Q>
      <Q ID="58">  131   132   133   115 </Q>
      <Q ID="59">  133   134   135   117 </Q>
      <Q ID="60">  135   136   137   119 </Q>
      <Q ID="61">  137   138   139   121 </Q>
      <Q ID="62">  139   140   141   123 </Q>
      <Q ID="63">  141   142   143   125 </Q>
    </ELEMENT>
    <COMPOSITE>
      <C ID="0"> Q[0-63] </C>
      <C ID="1"> E[3,6,9,12,15,18,21,24] </C>
      <C ID="2"> E[128,130,132,134,136,138,140,142] </C>
      <C ID="3"> E[0,23,25,41-42,58-59,75-76,92-93,109-110,126-127,143] </C>
    </COMPOSITE>
    <DOMAIN> C[0] </DOMAIN>
  </GEOMETRY>
  <EXPANSIONS>
    <E COMPOSITE="C[0]" NUMMODES="4" FIELDS="p" TYPE="MODIFIED"/>
    <E COMPOSITE="C[0]" NUMMODES="4" FIELDS="u" TYPE="MODIFIED"/>
    <E COMPOSITE="C[0]" NUMMODES="4" FIELDS="v" TYPE="MODIFIED"/>
  </EXPANSIONS>
  <CONDITIONS>
    <SOLVERINFO>
      <I PROPERTY="EQType" VALUE="APE"/> <!-- Acoustic perturbation equations -->
      <I PROPERTY="Projection" VALUE="DisContinuous"/>
      <I PROPERTY="TimeIntegrationMethod" VALUE="ClassicalRungeKutta4"/>
      <I PROPERTY="UpwindType" VALUE="Upwind"/>
    </SOLVERINFO>
    <PARAMETERS>
      <P> TimeStep       = 0.00001            </P>
      <P> NumSteps       = 400                </P>
      <P> FinTime        = TimeStep*NumSteps  </P>
      <P> IO_CheckSteps  = 10                 </P>
      <P> IO_InfoSteps   = 10                 </P>
      <P> Rho0           = 1.204              </P> <!-- Incompressible density -->
      <P> Pinfinity      = 100000             </P> <!-- Ambient pressure -->
    </PARAMETERS>
    <VARIABLES>
      <V ID="0"> p  </V>
      <V ID="1"> u </V>
      <V ID="2"> v </V>
    </VARIABLES>
    <BOUNDARYREGIONS>
      <B ID="0"> C[2,3]  </B>
      <B ID="1"> C[1]  </B>
    </BOUNDARYREGIONS>
    <BOUNDARYCONDITIONS>
      <REGION REF="0">
        <D VAR="p" USERDEFINEDTYPE="RiemannInvariantBC" VALUE="0" />
        <D VAR="u" USERDEFINEDTYPE="RiemannInvariantBC" VALUE="0" />
        <D VAR="v" USERDEFINEDTYPE="RiemannInvariantBC" VALUE="0" />
      </REGION>
      <REGION REF="1">
        <D VAR="p" USERDEFINEDTYPE="Wall" VALUE="0" />
        <D VAR="u" USERDEFINEDTYPE="Wall" VALUE="0" />
        <D VAR="v" USERDEFINEDTYPE="Wall" VALUE="0" />
      </REGION>
    </BOUNDARYCONDITIONS>
    <FUNCTION NAME="Baseflow"> <!-- Incompressible base flow -->
      <E VAR="u0" VALUE="0"/>
      <E VAR="v0" VALUE="0"/>
      <E VAR="c0sq" VALUE="1.4 * Pinfinity / Rho0"/>
      <E VAR="rho0" VALUE="Rho0"/>
    </FUNCTION>
    <FUNCTION NAME="ExactSolution">
      <E VAR="p" VALUE="0"/>
      <E VAR="u" VALUE="0"/>
      <E VAR="v" VALUE="0"/>
    </FUNCTION>
    <FUNCTION NAME="InitialConditions">
      <E VAR="p" VALUE="100*exp(-32*(x^2+y^2))"/> <!-- Gaussian pulse located at the origin -->
      <E VAR="u" VALUE="0"/>
      <E VAR="v" VALUE="0"/>
    </FUNCTION>
    <!-- 0.4 m thick sponge layer around the RiemannInvariantBC BCs -->
    <FUNCTION NAME="SpongeCoefficient">
        <E VAR="p" EVARS="r" VALUE="-5000 * exp(-0.5 * (3*r / 0.4)^2)" />
        <E VAR="u" EVARS="r" VALUE="-5000 * exp(-0.5 * (3*r / 0.4)^2)" />
        <E VAR="v" EVARS="r" VALUE="-5000 * exp(-0.5 * (3*r / 0.4)^2)" />
    </FUNCTION>
  </CONDITIONS>
  <FORCING>
    <FORCE TYPE="Absorption">
        <COEFF> SpongeCoefficient </COEFF>
        <BOUNDARYREGIONS> 0 </BOUNDARYREGIONS>
    </FORCE>
  </FORCING>
</NEKTAR>

<?xml version="1.0" encoding="utf-8" ?>
<NEKTAR>
    <GEOMETRY DIM="2" SPACE="2">
        <VERTEX>
            <V ID="0">0.00000000e+00 0.00000000e+00 0.00000000e+00</V>
            <V ID="1">1.25000000e-01 0.00000000e+00 0.00000000e+00</V>
            <V ID="2">1.25000000e-01 1.25000000e-01 0.00000000e+00</V>
            <V ID="3">0.00000000e+00 1.25000000e-01 0.00000000e+00</V>
            <V ID="4">2.50000000e-01 0.00000000e+00 0.00000000e+00</V>
            <V ID="5">2.50000000e-01 1.25000000e-01 0.00000000e+00</V>
            <V ID="6">3.75000000e-01 0.00000000e+00 0.00000000e+00</V>
            <V ID="7">3.75000000e-01 1.25000000e-01 0.00000000e+00</V>
            <V ID="8">5.00000000e-01 0.00000000e+00 0.00000000e+00</V>
            <V ID="9">5.00000000e-01 1.25000000e-01 0.00000000e+00</V>
            <V ID="10">6.25000000e-01 0.00000000e+00 0.00000000e+00</V>
            <V ID="11">6.25000000e-01 1.25000000e-01 0.00000000e+00</V>
            <V ID="12">7.50000000e-01 0.00000000e+00 0.00000000e+00</V>
            <V ID="13">7.50000000e-01 1.25000000e-01 0.00000000e+00</V>
            <V ID="14">8.75000000e-01 0.00000000e+00 0.00000000e+00</V>
            <V ID="15">8.75000000e-01 1.25000000e-01 0.00000000e+00</V>
            <V ID="16">1.00000000e+00 0.00000000e+00 0.00000000e+00</V>
            <V ID="17">1.00000000e+00 1.25000000e-01 0.00000000e+00</V>
            <V ID="18">1.25000000e-01 2.50000000e-01 0.00000000e+00</V>
            <V ID="19">0.00000000e+00 2.50000000e-01 0.00000000e+00</V>
            <V ID="20">2.50000000e-01 2.50000000e-01 0.00000000e+00</V>
            <V ID="21">3.75000000e-01 2.50000000e-01 0.00000000e+00</V>
            <V ID="22">5.00000000e-01 2.50000000e-01 0.00000000e+00</V>
            <V ID="23">6.25000000e-01 2.50000000e-01 0.00000000e+00</V>
            <V ID="24">7.50000000e-01 2.50000000e-01 0.00000000e+00</V>
            <V ID="25">8.75000000e-01 2.50000000e-01 0.00000000e+00</V>
            <V ID="26">1.00000000e+00 2.50000000e-01 0.00000000e+00</V>
            <V ID="27">1.25000000e-01 3.75000000e-01 0.00000000e+00</V>
            <V ID="28">0.00000000e+00 3.75000000e-01 0.00000000e+00</V>
            <V ID="29">2.50000000e-01 3.75000000e-01 0.00000000e+00</V>
            <V ID="30">3.75000000e-01 3.75000000e-01 0.00000000e+00</V>
            <V ID="31">5.00000000e-01 3.75000000e-01 0.00000000e+00</V>
            <V ID="32">6.25000000e-01 3.75000000e-01 0.00000000e+00</V>
            <V ID="33">7.50000000e-01 3.75000000e-01 0.00000000e+00</V>
            <V ID="34">8.75000000e-01 3.75000000e-01 0.00000000e+00</V>
            <V ID="35">1.00000000e+00 3.75000000e-01 0.00000000e+00</V>
            <V ID="36">1.25000000e-01 5.00000000e-01 0.00000000e+00</V>
            <V ID="37">0.00000000e+00 5.00000000e-01 0.00000000e+00</V>
            <V ID="38">2.50000000e-01 5.00000000e-01 0.00000000e+00</V>
            <V ID="39">3.75000000e-01 5.00000000e-01 0.00000000e+00</V>
            <V ID="40">5.00000000e-01 5.00000000e-01 0.00000000e+00</V>
            <V ID="41">6.25000000e-01 5.00000000e-01 0.00000000e+00</V>
            <V ID="42">7.50000000e-01 5.00000000e-01 0.00000000e+00</V>
            <V ID="43">8.75000000e-01 5.00000000e-01 0.00000000e+00</V>
            <V ID="44">1.00000000e+00 5.00000000e-01 0.00000000e+00</V>
            <V ID="45">1.25000000e-01 6.25000000e-01 0.00000000e+00</V>
            <V ID="46">0.00000000e+00 6.25000000e-01 0.00000000e+00</V>
            <V ID="47">2.50000000e-01 6.25000000e-01 0.00000000e+00</V>
            <V ID="48">3.75000000e-01 6.25000000e-01 0.00000000e+00</V>
            <V ID="49">5.00000000e-01 6.25000000e-01 0.00000000e+00</V>
            <V ID="50">6.25000000e-01 6.25000000e-01 0.00000000e+00</V>
            <V ID="51">7.50000000e-01 6.25000000e-01 0.00000000e+00</V>
            <V ID="52">8.75000000e-01 6.25000000e-01 0.00000000e+00</V>
            <V ID="53">1.00000000e+00 6.25000000e-01 0.00000000e+00</V>
            <V ID="54">1.25000000e-01 7.50000000e-01 0.00000000e+00</V>
            <V ID="55">0.00000000e+00 7.50000000e-01 0.00000000e+00</V>
            <V ID="56">2.50000000e-01 7.50000000e-01 0.00000000e+00</V>
            <V ID="57">3.75000000e-01 7.50000000e-01 0.00000000e+00</V>
            <V ID="58">5.00000000e-01 7.50000000e-01 0.00000000e+00</V>
            <V ID="59">6.25000000e-01 7.50000000e-01 0.00000000e+00</V>
            <V ID="60">7.50000000e-01 7.50000000e-01 0.00000000e+00</V>
            <V ID="61">8.75000000e-01 7.50000000e-01 0.00000000e+00</V>
            <V ID="62">1.00000000e+00 7.50000000e-01 0.00000000e+00</V>
            <V ID="63">1.25000000e-01 8.75000000e-01 0.00000000e+00</V>
            <V ID="64">0.00000000e+00 8.75000000e-01 0.00000000e+00</V>
            <V ID="65">2.50000000e-01 8.75000000e-01 0.00000000e+00</V>
            <V ID="66">3.75000000e-01 8.75000000e-01 0.00000000e+00</V>
            <V ID="67">5.00000000e-01 8.75000000e-01 0.00000000e+00</V>
            <V ID="68">6.25000000e-01 8.75000000e-01 0.00000000e+00</V>
            <V ID="69">7.50000000e-01 8.75000000e-01 0.00000000e+00</V>
            <V ID="70">8.75000000e-01 8.75000000e-01 0.00000000e+00</V>
            <V ID="71">1.00000000e+00 8.75000000e-01 0.00000000e+00</V>
            <V ID="72">1.25000000e-01 1.00000000e+00 0.00000000e+00</V>
            <V ID="73">0.00000000e+00 1.00000000e+00 0.00000000e+00</V>
            <V ID="74">2.50000000e-01 1.00000000e+00 0.00000000e+00</V>
            <V ID="75">3.75000000e-01 1.00000000e+00 0.00000000e+00</V>
            <V ID="76">5.00000000e-01 1.00000000e+00 0.00000000e+00</V>
            <V ID="77">6.25000000e-01 1.00000000e+00 0.00000000e+00</V>
            <V ID="78">7.50000000e-01 1.00000000e+00 0.00000000e+00</V>
            <V ID="79">8.75000000e-01 1.00000000e+00 0.00000000e+00</V>
            <V ID="80">1.00000000e+00 1.00000000e+00 0.00000000e+00</V>
        </VERTEX>
        <EDGE>
            <E ID="0">1 0</E>
            <E ID="1">2 1</E>
            <E ID="2">3 2</E>
            <E ID="3">0 3</E>
            <E ID="4">4 1</E>
            <E ID="5">5 4</E>
            <E ID="6">2 5</E>
            <E ID="7">6 4</E>
            <E ID="8">7 6</E>
            <E ID="9">5 7</E>
            <E ID="10">8 6</E>
            <E ID="11">9 8</E>
            <E ID="12">7 9</E>
            <E ID="13">10 8</E>
            <E ID="14">11 10</E>
            <E ID="15">9 11</E>
            <E ID="16">12 10</E>
            <E ID="17">13 12</E>
            <E ID="18">11 13</E>
            <E ID="19">14 12</E>
            <E ID="20">15 14</E>
            <E ID="21">13 15</E>
            <E ID="22">16 14</E>
            <E ID="23">17 16</E>
            <E ID="24">15 17</E>
            <E ID="25">18 2</E>
            <E ID="26">19 18</E>
            <E ID="27">3 19</E>
            <E ID="28">20 5</E>
            <E ID="29">18 20</E>
            <E ID="30">21 7</E>
            <E ID="31">20 21</E>
            <E ID="32">22 9</E>
            <E ID="33">21 22</E>
            <E ID="34">23 11</E>
            <E ID="35">22 23</E>
            <E ID="36">24 13</E>
            <E ID="37">23 24</E>
            <E ID="38">25 15</E>
            <E ID="39">24 25</E>
            <E ID="40">26 17</E>
            <E ID="41">25 26</E>
            <E ID="42">27 18</E>
            <E ID="43">28 27</E>
            <E ID="44">19 28</E>
            <E ID="45">29 20</E>
            <E ID="46">27 29</E>
            <E ID="47">30 21</E>
            <E ID="48">29 30</E>
            <E ID="49">31 22</E>
            <E ID="50">30 31</E>
            <E ID="51">32 23</E>
            <E ID="52">31 32</E>
            <E ID="53">33 24</E>
            <E ID="54">32 33</E>
            <E ID="55">34 25</E>
            <E ID="56">33 34</E>
            <E ID="57">35 26</E>
            <E ID="58">34 35</E>
            <E ID="59">36 27</E>
            <E ID="60">37 36</E>
            <E ID="61">28 37</E>
            <E ID="62">38 29</E>
            <E ID="63">36 38</E>
            <E ID="64">39 30</E>
            <E ID="65">38 39</E>
            <E ID="66">40 31</E>
            <E ID="67">39 40</E>
            <E ID="68">41 32</E>
            <E ID="69">40 41</E>
            <E ID="70">42 33</E>
            <E ID="71">41 42</E>
            <E ID="72">43 34</E>
            <E ID="73">42 43</E>
            <E ID="74">44 35</E>
            <E ID="75">43 44</E>
            <E ID="76">45 36</E>
            <E ID="77">46 45</E>
            <E ID="78">37 46</E>
            <E ID="79">47 38</E>
            <E ID="80">45 47</E>
            <E ID="81">48 39</E>
            <E ID="82">47 48</E>
            <E ID="83">49 40</E>
            <E ID="84">48 49</E>
            <E ID="85">50 41</E>
            <E ID="86">49 50</E>
            <E ID="87">51 42</E>
            <E ID="88">50 51</E>
            <E ID="89">52 43</E>
            <E ID="90">51 52</E>
            <E ID="91">53 44</E>
            <E ID="92">52 53</E>
            <E ID="93">54 45</E>
            <E ID="94">55 54</E>
            <E ID="95">46 55</E>
            <E ID="96">56 47</E>
            <E ID="97">54 56</E>
            <E ID="98">57 48</E>
            <E ID="99">56 57</E>
            <E ID="100">58 49</E>
            <E ID="101">57 58</E>
            <E ID="102">59 50</E>
            <E ID="103">58 59</E>
            <E ID="104">60 51</E>
            <E ID="105">59 60</E>
            <E ID="106">61 52</E>
            <E ID="107">60 61</E>
            <E ID="108">62 53</E>
            <E ID="109">61 62</E>
            <E ID="110">63 54</E>
            <E ID="111">64 63</E>
            <E ID="112">55 64</E>
            <E ID="113">65 56</E>
            <E ID="114">63 65</E>
            <E ID="115">66 57</E>
            <E ID="116">65 66</E>
            <E ID="117">67 58</E>
            <E ID="118">66 67</E>
            <E ID="119">68 59</E>
            <E ID="120">67 68</E>
            <E ID="121">69 60</E>
            <E ID="122">68 69</E>
            <E ID="123">70 61</E>
            <E ID="124">69 70</E>
            <E ID="125">71 62</E>
            <E ID="126">70 71</E>
            <E ID="127">72 63</E>
            <E ID="128">73 72</E>
            <E ID="129">64 73</E>
            <E ID="130">74 65</E>
            <E ID="131">72 74</E>
            <E ID="132">75 66</E>
            <E ID="133">74 75</E>
            <E ID="134">76 67</E>
            <E ID="135">75 76</E>
            <E ID="136">77 68</E>
            <E ID="137">76 77</E>
            <E ID="138">78 69</E>
            <E ID="139">77 78</E>
            <E ID="140">79 70</E>
            <E ID="141">78 79</E>
            <E ID="142">80 71</E>
            <E ID="143">79 80</E>
        </EDGE>
        <ELEMENT>
            <Q ID="0">0 1 2 3</Q>
            <Q ID="1">4 5 6 1</Q>
            <Q ID="2">7 8 9 5</Q>
            <Q ID="3">10 11 12 8</Q>
            <Q ID="4">13 14 15 11</Q>
            <Q ID="5">16 17 18 14</Q>
            <Q ID="6">19 20 21 17</Q>
            <Q ID="7">22 23 24 20</Q>
            <Q ID="8">2 25 26 27</Q>
            <Q ID="9">6 28 29 25</Q>
            <Q ID="10">9 30 31 28</Q>
            <Q ID="11">12 32 33 30</Q>
            <Q ID="12">15 34 35 32</Q>
            <Q ID="13">18 36 37 34</Q>
            <Q ID="14">21 38 39 36</Q>
            <Q ID="15">24 40 41 38</Q>
            <Q ID="16">26 42 43 44</Q>
            <Q ID="17">29 45 46 42</Q>
            <Q ID="18">31 47 48 45</Q>
            <Q ID="19">33 49 50 47</Q>
            <Q ID="20">35 51 52 49</Q>
            <Q ID="21">37 53 54 51</Q>
            <Q ID="22">39 55 56 53</Q>
            <Q ID="23">41 57 58 55</Q>
            <Q ID="24">43 59 60 61</Q>
            <Q ID="25">46 62 63 59</Q>
            <Q ID="26">48 64 65 62</Q>
            <Q ID="27">50 66 67 64</Q>
            <Q ID="28">52 68 69 66</Q>
            <Q ID="29">54 70 71 68</Q>
            <Q ID="30">56 72 73 70</Q>
            <Q ID="31">58 74 75 72</Q>
            <Q ID="32">60 76 77 78</Q>
            <Q ID="33">63 79 80 76</Q>
            <Q ID="34">65 81 82 79</Q>
            <Q ID="35">67 83 84 81</Q>
            <Q ID="36">69 85 86 83</Q>
            <Q ID="37">71 87 88 85</Q>
            <Q ID="38">73 89 90 87</Q>
            <Q ID="39">75 91 92 89</Q>
            <Q ID="40">77 93 94 95</Q>
            <Q ID="41">80 96 97 93</Q>
            <Q ID="42">82 98 99 96</Q>
            <Q ID="43">84 100 101 98</Q>
            <Q ID="44">86 102 103 100</Q>
            <Q ID="45">88 104 105 102</Q>
            <Q ID="46">90 106 107 104</Q>
            <Q ID="47">92 108 109 106</Q>
            <Q ID="48">94 110 111 112</Q>
            <Q ID="49">97 113 114 110</Q>
            <Q ID="50">99 115 116 113</Q>
            <Q ID="51">101 117 118 115</Q>
            <Q ID="52">103 119 120 117</Q>
            <Q ID="53">105 121 122 119</Q>
            <Q ID="54">107 123 124 121</Q>
            <Q ID="55">109 125 126 123</Q>
            <Q ID="56">111 127 128 129</Q>
            <Q ID="57">114 130 131 127</Q>
            <Q ID="58">116 132 133 130</Q>
            <Q ID="59">118 134 135 132</Q>
            <Q ID="60">120 136 137 134</Q>
            <Q ID="61">122 138 139 136</Q>
            <Q ID="62">124 140 141 138</Q>
            <Q ID="63">126 142 143 140</Q>
        </ELEMENT>
        <CURVED />
        <COMPOSITE>
            <C ID="1"> E[0,4,7,10,13,16,19,22] </C>
            <C ID="2"> E[23,40,57,74,91,108,125,142] </C>
            <C ID="3"> E[128,131,133,135,137,139,141,143] </C>
            <C ID="4"> E[3,27,44,61,78,95,112,129] </C>
            <C ID="5"> Q[0-63] </C>
        </COMPOSITE>
        <DOMAIN> C[5] </DOMAIN>
    </GEOMETRY>
    <Metadata>
        <Provenance>
            <GitBranch>refs/heads/feature_ImplicitSolver</GitBranch>
            <GitSHA1>5ae7e1f7470867d5b70ce7179c8226fe0b4bd1e1</GitSHA1>
            <Hostname>ae-yp3015</Hostname>
            <NektarVersion>4.5.0</NektarVersion>
            <Timestamp>30-Nov-2018 13:46:37</Timestamp>
        </Provenance>
        <NekMeshCommandLine>MMS.msh MMS_8_8.xml:xml:uncompress </NekMeshCommandLine>
    </Metadata>
    
  <EXPANSIONS>
        <E COMPOSITE="C[5]" NUMMODES="3" TYPE="MODIFIED" FIELDS="rho,rhou,rhov,E" />
    </EXPANSIONS>
      <CONDITIONS>
    <PARAMETERS>
      <P> TimeStep              = 2.5E-5                    </P>
      <P> NumSteps              = 1000                       </P>
      <P> IO_CheckSteps         = 50000                    </P>
      <P> IO_InfoSteps          = 1000                    </P>
      <P> GasConstant           = 287.058                   </P>
      <P> Gamma                 = 1.4                       </P>
      <P> Cp                    = Gamma*GasConstant/(Gamma-1)      </P>
      <P> L                     = 1                         </P>
      <P> pInf                  = 101325                    </P>
      <P> rhoInf                = 1.225                     </P>
      <P> Twall                 = 300.15                    </P>
      <P> cInf                  = sqrt(Gamma*pInf/rhoInf)   </P>
      <P> Re                    = 100                       </P>
      <P> Ma                    = 0.3                       </P>
      <P> uInf                  = Ma*cInf                   </P>
      <P> vInf                  = 0.0                       </P>
      <P> mu                    = Re/(rhoInf*uInf*L)        </P>
      <P> Pr                    = 0.72                      </P> 

      <P> rho0                   = rhoInf                   </P>
      <P> u0                     = uInf                     </P>
      <P> v0                     = vInf                     </P>
      <P> p0                     = pInf                     </P>
      <P> px                     = -8*mu*u0                 </P>
      <P> cadd                   = 0.1                </P>
      
    </PARAMETERS>

     <SOLVERINFO>
        <I PROPERTY="EQType"                VALUE="NavierStokesCFE"     />
        <I PROPERTY="Projection"            VALUE="DisContinuous"       />
        <I PROPERTY="AdvectionType"         VALUE="WeakDG"              />
        <I PROPERTY="DiffusionType"         VALUE="InteriorPenalty"               />
        <I PROPERTY="TimeIntegrationMethod" VALUE="ForwardEuler"/>
        <I PROPERTY="UpwindType"            VALUE="Roe"                />
        <I PROPERTY="ProblemType"           VALUE="General"             />
        <I PROPERTY="ViscosityType"         VALUE="Constant"            />

        <I PROPERTY="useUnifiedWeakIntegration"  VALUE="True"/>

    </SOLVERINFO>

    <VARIABLES>
      <V ID="0"> rho  </V>
      <V ID="1"> rhou </V>
      <V ID="2"> rhov </V>
      <V ID="3"> E    </V>
    </VARIABLES>

    <BOUNDARYREGIONS>
      <B ID="0"> C[1] </B>
      <B ID="1"> C[2] </B>
      <B ID="2"> C[3] </B>
      <B ID="3"> C[4] </B>
    </BOUNDARYREGIONS>

    <BOUNDARYCONDITIONS>
    <!--    Dirichlet -->  
      <REGION REF="0">
        <D VAR="rho"  VALUE=" rho0 " />
        <D VAR="rhou" VALUE=" -(px*rho0*(y*(L - y) - cadd*y^2*(L - y)^2))/(2*mu) " />
        <D VAR="rhov" VALUE=" rho0*v0 "/>
        <D VAR="E"    VALUE=" rho0*((p0 + px*x)/(rho0*(Gamma - 1)) + (px^2*(y*(L - y) - cadd*y^2*(L - y)^2)^2)/(8*mu^2)) " />
      </REGION>


      <REGION REF="1">
        <D VAR="rho"  VALUE=" rho0 " />
        <D VAR="rhou" VALUE=" -(px*rho0*(y*(L - y) - cadd*y^2*(L - y)^2))/(2*mu) " />
        <D VAR="rhov" VALUE=" rho0*v0 "/>
        <D VAR="E"    VALUE=" rho0*((p0 + px*x)/(rho0*(Gamma - 1)) + (px^2*(y*(L - y) - cadd*y^2*(L - y)^2)^2)/(8*mu^2)) " />
      </REGION>

      <REGION REF="2">
        <D VAR="rho"  VALUE=" rho0 " />
        <D VAR="rhou" VALUE=" -(px*rho0*(y*(L - y) - cadd*y^2*(L - y)^2))/(2*mu) " />
        <D VAR="rhov" VALUE=" rho0*v0 "/>
        <D VAR="E"    VALUE=" rho0*((p0 + px*x)/(rho0*(Gamma - 1)) + (px^2*(y*(L - y) - cadd*y^2*(L - y)^2)^2)/(8*mu^2)) " />
      </REGION>

      <REGION REF="3">
        <D VAR="rho"  VALUE=" rho0 " />
        <D VAR="rhou" VALUE=" -(px*rho0*(y*(L - y) - cadd*y^2*(L - y)^2))/(2*mu) " />
        <D VAR="rhov" VALUE=" rho0*v0 "/>
        <D VAR="E"    VALUE=" rho0*((p0 + px*x)/(rho0*(Gamma - 1)) + (px^2*(y*(L - y) - cadd*y^2*(L - y)^2)^2)/(8*mu^2)) " />
      </REGION>

    </BOUNDARYCONDITIONS>

    <FUNCTION NAME="InitialConditions">
        <E VAR="rho"  VALUE=" rho0 " />
        <E VAR="rhou" VALUE=" -(px*rho0*(y*(L - y) - cadd*y^2*(L - y)^2))/(2*mu) " />
        <E VAR="rhov" VALUE=" rho0*v0 "/>
        <E VAR="E"    VALUE=" rho0*((p0 + px*x)/(rho0*(Gamma - 1)) + (px^2*(y*(L - y) - cadd*y^2*(L - y)^2)^2)/(8*mu^2)) " />
    </FUNCTION>
    
    <FUNCTION NAME="ExactSolution">
        <E VAR="rho"  VALUE=" rho0 " />
        <E VAR="rhou" VALUE=" -(px*rho0*(y*(L - y) - cadd*y^2*(L - y)^2))/(2*mu) " />
        <E VAR="rhov" VALUE=" rho0*v0 "/>
        <E VAR="E"    VALUE=" rho0*((p0 + px*x)/(rho0*(Gamma - 1)) + (px^2*(y*(L - y) - cadd*y^2*(L - y)^2)^2)/(8*mu^2)) " />
    </FUNCTION>
    
    <FUNCTION NAME="BodyForce">
        <E VAR="rho"  VALUE=" 0 " />
        <E VAR="rhou" VALUE=" -cadd*px*(L^2 - 6*L*y + 6*y^2) " />
        <E VAR="rhov" VALUE=" 0 " />
        <E VAR="E"    VALUE=" (px^2*y*(L - y)*(cadd*y^2 - L*cadd*y + 1)*(2*cadd*y^2 - 2*L*cadd*y + 1))/(2*mu) 
                            - (px^2*y*(L - y)*(cadd*y^2 - L*cadd*y + 1))/(2*mu) - (px^2*y*(L - y)*(cadd*y^2 - L*cadd*y + 1))
                            /(2*mu*(Gamma - 1)) - (px^2*(L - 2*y)^2*(2*cadd*y^2 - 2*L*cadd*y + 1)^2)/(4*mu) + 
                            (cadd*px^2*y*(L - y)*(L - 2*y)^2*(cadd*y^2 - L*cadd*y + 1))/(2*mu)" />
    </FUNCTION>

  </CONDITIONS>
  <FORCING>
    <FORCE TYPE="Body">
      <BODYFORCE> BodyForce </BODYFORCE>
    </FORCE>
  </FORCING>
</NEKTAR>
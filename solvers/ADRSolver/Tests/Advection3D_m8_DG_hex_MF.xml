<?xml version="1.0" encoding="utf-8" ?>
<NEKTAR>
  <GEOMETRY DIM="3" SPACE="3">
    <VERTEX>
      <V ID="0">0.00000000e+00 -2.50000000e-01 -4.00000000e-01</V>
      <V ID="1">1.30000000e+00 -2.50000000e-01 -4.00000000e-01</V>
      <V ID="2">1.30000000e+00 6.50000000e-01 -4.00000000e-01</V>
      <V ID="3">0.00000000e+00 6.50000000e-01 -4.00000000e-01</V>
      <V ID="4">0.00000000e+00 -2.50000000e-01 2.33333333e-01</V>
      <V ID="5">1.30000000e+00 -2.50000000e-01 2.33333333e-01</V>
      <V ID="6">1.30000000e+00 6.50000000e-01 2.33333333e-01</V>
      <V ID="7">0.00000000e+00 6.50000000e-01 2.33333333e-01</V>
      <V ID="8">0.00000000e+00 -2.50000000e-01 8.66666667e-01</V>
      <V ID="9">1.30000000e+00 -2.50000000e-01 8.66666667e-01</V>
      <V ID="10">1.30000000e+00 6.50000000e-01 8.66666667e-01</V>
      <V ID="11">0.00000000e+00 6.50000000e-01 8.66666667e-01</V>
      <V ID="12">0.00000000e+00 -2.50000000e-01 1.50000000e+00</V>
      <V ID="13">1.30000000e+00 -2.50000000e-01 1.50000000e+00</V>
      <V ID="14">1.30000000e+00 6.50000000e-01 1.50000000e+00</V>
      <V ID="15">0.00000000e+00 6.50000000e-01 1.50000000e+00</V>
      <V ID="16">1.30000000e+00 1.55000000e+00 -4.00000000e-01</V>
      <V ID="17">0.00000000e+00 1.55000000e+00 -4.00000000e-01</V>
      <V ID="18">1.30000000e+00 1.55000000e+00 2.33333333e-01</V>
      <V ID="19">0.00000000e+00 1.55000000e+00 2.33333333e-01</V>
      <V ID="20">1.30000000e+00 1.55000000e+00 8.66666667e-01</V>
      <V ID="21">0.00000000e+00 1.55000000e+00 8.66666667e-01</V>
      <V ID="22">1.30000000e+00 1.55000000e+00 1.50000000e+00</V>
      <V ID="23">0.00000000e+00 1.55000000e+00 1.50000000e+00</V>
    </VERTEX>
    <EDGE>
      <E ID="0">    0  1   </E>
      <E ID="1">    0  3   </E>
      <E ID="2">    0  4   </E>
      <E ID="3">    1  2   </E>
      <E ID="4">    1  5   </E>
      <E ID="5">    2  3   </E>
      <E ID="6">    2  6   </E>
      <E ID="7">    3  7   </E>
      <E ID="8">    4  5   </E>
      <E ID="9">    4  7   </E>
      <E ID="10">    5  6   </E>
      <E ID="11">    6  7   </E>
      <E ID="12">    4  8   </E>
      <E ID="13">    5  9   </E>
      <E ID="14">    6  10   </E>
      <E ID="15">    7  11   </E>
      <E ID="16">    8  9   </E>
      <E ID="17">    8  11   </E>
      <E ID="18">    9  10   </E>
      <E ID="19">   10  11   </E>
      <E ID="20">    8  12   </E>
      <E ID="21">    9  13   </E>
      <E ID="22">   10  14   </E>
      <E ID="23">   11  15   </E>
      <E ID="24">   12  13   </E>
      <E ID="25">   12  15   </E>
      <E ID="26">   13  14   </E>
      <E ID="27">   14  15   </E>
      <E ID="28">    3  17   </E>
      <E ID="29">    2  16   </E>
      <E ID="30">   16  17   </E>
      <E ID="31">   16  18   </E>
      <E ID="32">   17  19   </E>
      <E ID="33">    7  19   </E>
      <E ID="34">    6  18   </E>
      <E ID="35">   18  19   </E>
      <E ID="36">   18  20   </E>
      <E ID="37">   19  21   </E>
      <E ID="38">   11  21   </E>
      <E ID="39">   10  20   </E>
      <E ID="40">   20  21   </E>
      <E ID="41">   20  22   </E>
      <E ID="42">   21  23   </E>
      <E ID="43">   15  23   </E>
      <E ID="44">   14  22   </E>
      <E ID="45">   22  23   </E>
    </EDGE>
    <FACE>
      <Q ID="0">         0         3         5         1</Q>
      <Q ID="1">         0         4         8         2</Q>
      <Q ID="2">         3         6        10         4</Q>
      <Q ID="3">         5         7        11         6</Q>
      <Q ID="4">         1         2         9         7</Q>
      <Q ID="5">         8        10        11         9</Q>
      <Q ID="6">         8        13        16        12</Q>
      <Q ID="7">        10        14        18        13</Q>
      <Q ID="8">        11        15        19        14</Q>
      <Q ID="9">         9        12        17        15</Q>
      <Q ID="10">        16        18        19        17</Q>
      <Q ID="11">        16        21        24        20</Q>
      <Q ID="12">        18        22        26        21</Q>
      <Q ID="13">        19        23        27        22</Q>
      <Q ID="14">        17        20        25        23</Q>
      <Q ID="15">        24        26        27        25</Q>
      <Q ID="16">         5        29        30        28</Q>
      <Q ID="17">        29        31        34         6</Q>
      <Q ID="18">        30        32        35        31</Q>
      <Q ID="19">        28         7        33        32</Q>
      <Q ID="20">        11        34        35        33</Q>
      <Q ID="21">        34        36        39        14</Q>
      <Q ID="22">        35        37        40        36</Q>
      <Q ID="23">        33        15        38        37</Q>
      <Q ID="24">        19        39        40        38</Q>
      <Q ID="25">        39        41        44        22</Q>
      <Q ID="26">        40        42        45        41</Q>
      <Q ID="27">        38        23        43        42</Q>
      <Q ID="28">        27        44        45        43</Q>
    </FACE>
    <ELEMENT>
      <H ID="0">    0     1     2     3     4     5 </H>
      <H ID="1">    5     6     7     8     9    10 </H>
      <H ID="2">   10    11    12    13    14    15 </H>
      <H ID="3">   16     3    17    18    19    20 </H>
      <H ID="4">   20     8    21    22    23    24 </H>
      <H ID="5">   24    13    25    26    27    28 </H>
    </ELEMENT>
    <COMPOSITE>
      <C ID="0"> H[0-5] </C>
      <C ID="1"> F[0,16] </C>
      <C ID="2"> F[1,6,11] </C>
      <C ID="3"> F[2,7,12,17,21,25] </C>
      <C ID="4"> F[18,22,26] </C>
      <C ID="5"> F[4,9,14,19,23,27] </C>
      <C ID="6"> F[15,28] </C>
    </COMPOSITE>
    <DOMAIN> C[0] </DOMAIN>
  </GEOMETRY>


  <COLLECTIONS>
      <OPERATOR TYPE="BwdTrans">
          <ELEMENT TYPE="H" ORDER="2-8" IMPTYPE="MatrixFree" />
      </OPERATOR>
      <OPERATOR TYPE="IProductWRTDerivBase">
          <ELEMENT TYPE="H" ORDER="2-8" IMPTYPE="MatrixFree" />
      </OPERATOR>
  </COLLECTIONS>

  <EXPANSIONS>
    <E COMPOSITE="C[0]" NUMMODES="8" TYPE="MODIFIED" FIELDS="u" />
  </EXPANSIONS>
  <CONDITIONS>
    <PARAMETERS>
      <P> NumSteps       = 20         </P>
      <P> TimeStep       = 0.0015     </P>
      <P> IO_CheckSteps  = 200        </P>
      <P> IO_InfoSteps   = 1          </P>
      <P> advx           = 1          </P>
      <P> advy           = 1.5        </P>
      <P> advz           = 2          </P>
    </PARAMETERS>

    <SOLVERINFO>
      <I PROPERTY="EQTYPE"                  VALUE="UnsteadyAdvection"   />
      <I PROPERTY="Projection"              VALUE="DisContinuous"       />
        <I PROPERTY="AdvectionType"         VALUE="WeakDG"              />
        <I PROPERTY="UpwindType"            VALUE="Upwind"              />
        <I PROPERTY="TimeIntegrationMethod" VALUE="ClassicalRungeKutta4"/>
    </SOLVERINFO>

    <VARIABLES>
      <V ID="0"> u </V>
    </VARIABLES>

    <BOUNDARYREGIONS>
      <B ID="0"> C[1-6] </B>
    </BOUNDARYREGIONS>

    <BOUNDARYCONDITIONS>
      <REGION REF="0">
        <D VAR="u" USERDEFINEDTYPE="TimeDependent"
           VALUE="sin(PI*(x-advx*t))*sin(PI*(y-advy*t))*sin(PI*(z-advz*t))" />
      </REGION>
    </BOUNDARYCONDITIONS>

    <FUNCTION NAME="AdvectionVelocity">
      <E VAR="Vx" VALUE="advx" />
      <E VAR="Vy" VALUE="advy" />
      <E VAR="Vz" VALUE="advz" />
    </FUNCTION>

    <FUNCTION NAME="ExactSolution">
      <E VAR="u" VALUE="sin(PI*(x-advx*t))*sin(PI*(y-advy*t))*sin(PI*(z-advz*t))" />
    </FUNCTION>

    <FUNCTION NAME="InitialConditions">
      <E VAR="u" VALUE="sin(PI*x)*sin(PI*y)*sin(PI*z)" />
    </FUNCTION>
  </CONDITIONS>
</NEKTAR>

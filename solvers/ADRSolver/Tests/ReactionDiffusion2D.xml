<?xml version="1.0" encoding="utf-8" ?>
<NEKTAR>
    <GEOMETRY DIM="2" SPACE="2">
        <VERTEX COMPRESSED="B64Z-LittleEndian" BITSIZE="64">eJx9kUdOQ0EQBY2JJhkMBtvETzZgkgkmGzA5LmDJBdizQUgch0P4Fuw4go+AEBISmpmWSk/MpqVfv1/31MRi/586VzOFyv13VNsnj4Pzv3r8T96A77m/+hV4I/rJm9D/ERXfXj/jZc+b0U/eIvdPBJ6Q+xtvRf9j6SH/8pQMvA395O1y/1TgHXJ/453of36v1qo/6cCT6CfvkvfPBt4t72885SrfxZ8ecL5/Lzhz0uB8vz6Zb+/TD07/GZlvfrPg9JeT883PgKvc259BcPoZAqefYXDOGZH55mcUnH4imW9+xsDpZ1zONz8TrnIvfybB6WcKnH6mwelnRubbHnlw+pmV+eZnDpx+5uV881NwlXP9WQCnn0Vw+lkCp59lmW9+VsC5Z1Hmm59VcPpZk/PNz7qrzPVnA5x+SuD0swlOP1sy3/xsg9PPjsy3e+yC08+enG9+/EXY508ZnH4OwOnnEJx+jmS++amA08+xzDc/J+C856mcb37OXOV3f87B6ecCnH4uwennSuabn2tw+rmR+ebnFpx+7uR88/ALyo3F7gAA</VERTEX>
        <EDGE COMPRESSED="B64Z-LittleEndian" BITSIZE="64">eJx1lGlXzVEYRyORoiQyNVyFhEoyVeg2iKRIA0UTzUVCIxVp0KSv7M3ZL+y1/vfNs/ZvnXvuuWc/50lI+P9zIKIejKiJEZXPIa2HkyL4sJj9jmg965LFrDsqZr+UiO+nivn+sYj9jms9+6aJ2TddzH4ntJ7fyxDzeyfF7Jep9ZzjlJhznBazX5bWc74zYs53Vsx+50Klfzj3eTHnviCmX7KV839yxPRFrnL+Z54Y/zHl/P+LYjznK+deCsT4vKSc+7osxtsV5dxjoRg/V5Vzv0VivF0Llfvn3q+LufcbYjwUK8dHiRgPpcrxdFOMhzLl+LslxkO58liot8V4uKMc33fFeLinnD64L8ZDhXL6o1KMn6pQuX/65oGYvnkoxsMj5fRTtRgPceX0WY0YD7XK6b86MR7qldOXj8WxUBuU069PxHh4qpw+bhTj4Zly+rtJjJ/noXL/9H2zmL5vEePhhXLew0sxHlqV805eifHQppz30y7GQ4dy3lWnGA+vlfPe3ojx0KWcd9gtxsNb5bzPd2L89ITK/fNue8W82z4xHvqV854HxHh4r5x3/kGMh0HlvP8hMR6GlTMXRsR4GFXOvBgT42FcOXNkQoyHSeXMl49i/HwKlftn7kyJ46F+FuNhWjnz6IsYD1+VM6e+ifEwo5z5NSvGw5xy5tq8GA8Lypl3i2I8fFfOHPwhxsOScubjshg/K6Fy/8zNn2Lm5i9xPNRV5czT32I8rClnzq6L8bChnPm7KcbDH+XM5S0xHraVM693xHjYVc4c3xPj4a9y5vu+GD//AMnlVQ0A</EDGE>
        <ELEMENT>
            <Q COMPRESSED="B64Z-LittleEndian" BITSIZE="64">eJx11FdPFGEAheFVUHpfQPrSWXpH6oJSBaXbRcCKgoWiYKMIqCD4l715z4UncW+e5N1k5puTyQQC//4u4EWM+k+Pxkt42f5Xj8FYjLPrqsdjAibafdSTMBlT7H7qqZiG6XZO9QwMYqadWz0Ls/GKnT8HczEPtVuc9XwsQD1nvPVCLLJzJVgPYbFdJ9F6CZZikqlehuWoPZOtV2Alas8U61UYRu2p61ZjDdai9kyzXof1qD3TrTdgI2rPDOtN2IwhDFpvwVbUnpnW27AdtWeW9Q68itoz23ondqH21HvYjT3Yi9ozx3ofRlB75lrvxwHUnnnWr+F11J751gdxCLVngfVhHEHtWWh9FMdQexZZv4HjqD1DOIE38RZqz2LrkziF2rPE+jTOYD+WWp/FOdSeZdbn8TZqz3Lrd/Auas8K6/fwPmrPSusP8CFqT72Hj3ABH6P2DFtfxCXUntXWl/EJas8a60/xGWrPWuvP8QVqzzrrL3EFtWe99Vf4GrVng/VVXEPtqe/PG3yL71B7Nll/j+u4iM3WN3ATtWeL9S38gNqz1fpH3Ebt2WZ9Bz+h9my3/hm/oPbssP4Vv6H21PdxF/dwH7Vnp/UD/I7as8v6IR6h9uy2fow/UHv2WP+Jv1B79lo/wVPUnn3Wf+MZas+I9XP8g9rzL7yMTv4A</Q>
        </ELEMENT>
        <COMPOSITE>
            <C ID="0"> Q[0-63] </C>
            <C ID="1"> E[0,25,42,59,76,93,110,127] </C>
            <C ID="2"> E[128,130,132,134,136,138,140,142] </C>
            <C ID="3"> E[23,41,58,75,92,109,126,143] </C>
            <C ID="4"> E[3,6,9,12,15,18,21,24] </C>
        </COMPOSITE>
        <DOMAIN> C[0] </DOMAIN>
    </GEOMETRY>
    <Metadata>
        <Provenance>
            <GitBranch>refs/heads/feature/bodyforce-vars</GitBranch>
            <GitSHA1>5305c77133bf3fac0933a3327f72c12d2b2618e1</GitSHA1>
            <Hostname>kingscross</Hostname>
            <NektarVersion>5.0.0</NektarVersion>
            <Timestamp>14-Aug-2019 16:07:12</Timestamp>
        </Provenance>
        <NekMeshCommandLine>-m peralign:surf1=1:surf2=3:dir=y -m peralign:surf1=2:surf2=4:dir=x square-quads.msh DiffusionReaction2D.xml </NekMeshCommandLine>
    </Metadata>
    <EXPANSIONS>
        <E COMPOSITE="C[0]" NUMMODES="6" TYPE="MODIFIED" FIELDS="u" />
    </EXPANSIONS>
    <FORCING>
        <FORCE TYPE="Body">
            <BODYFORCE> BodyForce </BODYFORCE>
        </FORCE>
    </FORCING>
    <CONDITIONS>
        <PARAMETERS>
            <P> TimeStep       = 0.001            </P>
            <P> NumSteps       = 100              </P>
            <P> IO_CheckSteps  = 0                </P>
            <P> IO_InfoSteps   = 100              </P>
            <P> epsilon        = 0.2              </P>
        </PARAMETERS>

        <SOLVERINFO>
            <I PROPERTY="EQTYPE"                VALUE="UnsteadyReactionDiffusion" />
            <I PROPERTY="Projection"            VALUE="Continuous"                />
            <I PROPERTY="DiffusionAdvancement"  VALUE="Implicit"                  />
            <I PROPERTY="TimeIntegrationMethod" VALUE="IMEXOrder3"                />
        </SOLVERINFO>

        <VARIABLES>
            <V ID="0"> u </V>
        </VARIABLES>

        <BOUNDARYREGIONS>
            <B ID="0"> C[1] </B>
            <B ID="1"> C[2] </B>
            <B ID="2"> C[3] </B>
            <B ID="3"> C[4] </B>
        </BOUNDARYREGIONS>

        <BOUNDARYCONDITIONS>
            <REGION REF="0">
                <P VAR="u" VALUE="[2]" />
            </REGION>
            <REGION REF="1">
                <P VAR="u" VALUE="[3]" />
            </REGION>
            <REGION REF="2">
                <P VAR="u" VALUE="[0]" />
            </REGION>
            <REGION REF="3">
                <P VAR="u" VALUE="[1]" />
            </REGION>
        </BOUNDARYCONDITIONS>

        <FUNCTION NAME="ExactSolution">
            <E VAR="u" VALUE="exp(-0.1*t)*(cos(x) + cos(y))" />
        </FUNCTION>

        <FUNCTION NAME="InitialConditions">
            <E VAR="u" VALUE="cos(x) + cos(y)" />
        </FUNCTION>

        <!-- Body force to enforce reaction term -->
        <FUNCTION NAME="BodyForce">
            <E VAR="u" EVARS="u" VALUE="0.1*u" />
        </FUNCTION>
    </CONDITIONS>
</NEKTAR>

CMAKE_DEPENDENT_OPTION(NEKTAR_SOLVER_ADR
    "Build the ADR Solver." ON
    "NEKTAR_BUILD_SOLVERS" OFF)

IF( NEKTAR_SOLVER_ADR )
    SET(ADRSolverSource 
       ./ADRSolver.cpp 
       ./EquationSystems/Laplace.cpp
       ./EquationSystems/Poisson.cpp       
       ./EquationSystems/Helmholtz.cpp
       ./EquationSystems/SteadyAdvectionDiffusion.cpp
       ./EquationSystems/SteadyAdvectionDiffusionReaction.cpp
       ./EquationSystems/UnsteadyAdvection.cpp
       ./EquationSystems/UnsteadyDiffusion.cpp
       ./EquationSystems/UnsteadyAdvectionDiffusion.cpp
       ./EquationSystems/UnsteadyInviscidBurger.cpp
      #./EquationSystems/CFLtester.cpp
       ./EquationSystems/EigenValuesAdvection.cpp)

    ADD_SOLVER_EXECUTABLE(ADRSolver solvers 
        ${ADRSolverSource})

    # 1D discontinuous advection (weak DG/flux reconstruction)
    ADD_NEKTAR_TEST_LENGTHY(Advection1D_FRDG_GLL_LAGRANGE_SEM)
    ADD_NEKTAR_TEST        (Advection1D_FRDG_GAUSS_LAGRANGE)
    ADD_NEKTAR_TEST        (Advection1D_FRDG_GLL_LAGRANGE)
    ADD_NEKTAR_TEST        (Advection1D_FRDG_MODIFIED)
    ADD_NEKTAR_TEST_LENGTHY(Advection1D_FRSD_GLL_LAGRANGE_SEM)
    ADD_NEKTAR_TEST_LENGTHY(Advection1D_FRSD_GLL_LAGRANGE)
    ADD_NEKTAR_TEST_LENGTHY(Advection1D_FRSD_MODIFIED)
    ADD_NEKTAR_TEST_LENGTHY(Advection1D_FRHU_GLL_LAGRANGE_SEM)
    ADD_NEKTAR_TEST_LENGTHY(Advection1D_FRHU_GLL_LAGRANGE)
    ADD_NEKTAR_TEST_LENGTHY(Advection1D_FRHU_MODIFIED)
    ADD_NEKTAR_TEST        (Advection1D_WeakDG_GLL_LAGRANGE)
    ADD_NEKTAR_TEST        (Advection1D_WeakDG_GAUSS_LAGRANGE)
    ADD_NEKTAR_TEST        (Advection1D_WeakDG_MODIFIED)

    # 2D discontinuous advection (weak DG/flux reconstruction)
    ADD_NEKTAR_TEST        (Advection2D_dirichlet_deformed_GLL_LAGRANGE_10x10)
    ADD_NEKTAR_TEST        (Advection2D_dirichlet_deformed_GAUSS_LAGRANGE_10x10)
    ADD_NEKTAR_TEST_LENGTHY(Advection2D_dirichlet_deformed_GLL_LAGRANGE_SEM_10x10)
    ADD_NEKTAR_TEST        (Advection2D_dirichlet_deformed_MODIFIED_10x10)
    ADD_NEKTAR_TEST        (Advection2D_dirichlet_regular_GLL_LAGRANGE_10x10)
    ADD_NEKTAR_TEST        (Advection2D_dirichlet_regular_GAUSS_LAGRANGE_10x10)
    ADD_NEKTAR_TEST_LENGTHY(Advection2D_dirichlet_regular_GLL_LAGRANGE_SEM_10x10)
    ADD_NEKTAR_TEST        (Advection2D_dirichlet_regular_MODIFIED_10x10)
    ADD_NEKTAR_TEST_LENGTHY(Advection2D_ISO_deformed_GLL_LAGRANGE_3x3)
    ADD_NEKTAR_TEST_LENGTHY(Advection2D_ISO_deformed_GAUSS_LAGRANGE_3x3)
    ADD_NEKTAR_TEST_LENGTHY(Advection2D_ISO_deformed_GLL_LAGRANGE_SEM_3x3)
    ADD_NEKTAR_TEST_LENGTHY(Advection2D_ISO_deformed_MODIFIED_3x3)
    ADD_NEKTAR_TEST_LENGTHY(Advection2D_ISO_regular_GLL_LAGRANGE_3x3)
    ADD_NEKTAR_TEST_LENGTHY(Advection2D_ISO_regular_GAUSS_LAGRANGE_3x3)
    ADD_NEKTAR_TEST_LENGTHY(Advection2D_ISO_regular_GLL_LAGRANGE_SEM_3x3)
    ADD_NEKTAR_TEST_LENGTHY(Advection2D_ISO_regular_MODIFIED_3x3)
    ADD_NEKTAR_TEST        (Advection2D_periodic_deformed_GLL_LAGRANGE_2x2)
    ADD_NEKTAR_TEST        (Advection2D_periodic_deformed_GAUSS_LAGRANGE_2x2)
    ADD_NEKTAR_TEST_LENGTHY(Advection2D_periodic_deformed_GLL_LAGRANGE_SEM_2x2)
    ADD_NEKTAR_TEST        (Advection2D_periodic_deformed_MODIFIED_2x2)
    ADD_NEKTAR_TEST        (Advection2D_periodic_regular_GLL_LAGRANGE_2x2)
    ADD_NEKTAR_TEST        (Advection2D_periodic_regular_GAUSS_LAGRANGE_2x2)
    ADD_NEKTAR_TEST_LENGTHY(Advection2D_periodic_regular_GLL_LAGRANGE_SEM_2x2)
    ADD_NEKTAR_TEST        (Advection2D_periodic_regular_MODIFIED_2x2)
    ADD_NEKTAR_TEST_LENGTHY(Advection2D_periodic_deformed_GLL_LAGRANGE_10x10)
    ADD_NEKTAR_TEST_LENGTHY(Advection2D_periodic_deformed_GLL_LAGRANGE_SEM_10x10)
    ADD_NEKTAR_TEST_LENGTHY(Advection2D_periodic_deformed_MODIFIED_10x10)
    ADD_NEKTAR_TEST        (Advection_m12_DG_periodic)
    ADD_NEKTAR_TEST        (Advection2D_ISO_regular_SSPRK2)
    ADD_NEKTAR_TEST        (Advection2D_ISO_regular_SSPRK3)

    # 2D continuous advection (non-conservative)
    ADD_NEKTAR_TEST        (Advection_m12_Order1)
    ADD_NEKTAR_TEST        (Advection_m12_Order2)
    ADD_NEKTAR_TEST        (Advection_m14_Order4)

    # 3D discontinous advection
    ADD_NEKTAR_TEST_LENGTHY(Advection3D_m12_DG_hex_periodic_nodal)
    ADD_NEKTAR_TEST        (Advection3D_m12_DG_hex_nodal)
    ADD_NEKTAR_TEST        (Advection3D_m12_DG_hex_periodic)
    ADD_NEKTAR_TEST        (Advection3D_m12_DG_hex)
    ADD_NEKTAR_TEST        (Advection3D_m12_DG_hex_VarP)
    ADD_NEKTAR_TEST        (Advection3D_m12_DG_prism)
    ADD_NEKTAR_TEST        (Advection3D_m12_DG_prism_VarP)
    ADD_NEKTAR_TEST        (Advection3D_m12_DG_tet)
    ADD_NEKTAR_TEST        (Advection3D_m12_DG_tet_VarP)

    # 1D inviscid Burger (DG/FR)
    ADD_NEKTAR_TEST_LENGTHY(InviscidBurger1D_FRDG_GLL_LAGRANGE_SEM)
    ADD_NEKTAR_TEST        (InviscidBurger1D_FRDG_GAUSS_LAGRANGE)
    ADD_NEKTAR_TEST        (InviscidBurger1D_FRDG_GLL_LAGRANGE)
    ADD_NEKTAR_TEST        (InviscidBurger1D_FRDG_MODIFIED)
    ADD_NEKTAR_TEST_LENGTHY(InviscidBurger1D_FRSD_GLL_LAGRANGE_SEM)
    ADD_NEKTAR_TEST_LENGTHY(InviscidBurger1D_FRSD_GLL_LAGRANGE)
    ADD_NEKTAR_TEST_LENGTHY(InviscidBurger1D_FRSD_MODIFIED)
    ADD_NEKTAR_TEST_LENGTHY(InviscidBurger1D_FRHU_GLL_LAGRANGE_SEM)
    ADD_NEKTAR_TEST_LENGTHY(InviscidBurger1D_FRHU_GLL_LAGRANGE)
    ADD_NEKTAR_TEST_LENGTHY(InviscidBurger1D_FRHU_MODIFIED)
    ADD_NEKTAR_TEST        (InviscidBurger1D_WeakDG_GLL_LAGRANGE)
    ADD_NEKTAR_TEST        (InviscidBurger1D_WeakDG_GAUSS_LAGRANGE)
    ADD_NEKTAR_TEST        (InviscidBurger1D_WeakDG_MODIFIED)

    # 1D explicit diffusion (LDG/LFR)
    ADD_NEKTAR_TEST        (ExDiffusion_1D_LDG)
    ADD_NEKTAR_TEST        (ExDiffusion_1D_LDG_GAUSS)
    ADD_NEKTAR_TEST        (ExDiffusion_1D_LFRDG_GAUSS)
    ADD_NEKTAR_TEST_LENGTHY(ExDiffusion_1D_LFRSD_GAUSS)
    ADD_NEKTAR_TEST_LENGTHY(ExDiffusion_1D_LFRHU_GAUSS)
    ADD_NEKTAR_TEST        (ExDiffusion_1D_LFRDG)
    ADD_NEKTAR_TEST        (ExDiffusion_1D_LFRHU)
    ADD_NEKTAR_TEST_LENGTHY(ExDiffusion_1D_LFRSD)

    # 2D explicit diffusion (LDG/LFR)
    ADD_NEKTAR_TEST        (ExDiffusion_2D_LDG_hybrid_m3)
    ADD_NEKTAR_TEST_LENGTHY(ExDiffusion_2D_LDG_hybrid_m8)
    ADD_NEKTAR_TEST        (ExDiffusion_2D_LDG_regular_Neumann)
    ADD_NEKTAR_TEST        (ExDiffusion_2D_LDG_regular_Neumann_GAUSS)
    ADD_NEKTAR_TEST        (ExDiffusion_2D_LFRDG_regular_Neumann)
    ADD_NEKTAR_TEST        (ExDiffusion_2D_LFRDG_regular_Neumann_GAUSS)
    ADD_NEKTAR_TEST_LENGTHY(ExDiffusion_2D_LFRSD_regular_Neumann)
    ADD_NEKTAR_TEST_LENGTHY(ExDiffusion_2D_LFRSD_regular_Neumann_GAUSS)
    ADD_NEKTAR_TEST_LENGTHY(ExDiffusion_2D_LFRHU_regular_Neumann)
    ADD_NEKTAR_TEST_LENGTHY(ExDiffusion_2D_LFRHU_regular_Neumann_GAUSS)
    ADD_NEKTAR_TEST        (ExDiffusion_2D_LDG_deformed)
    ADD_NEKTAR_TEST        (ExDiffusion_2D_LDG_deformed_GAUSS)
    ADD_NEKTAR_TEST        (ExDiffusion_2D_LFRDG_deformed)
    ADD_NEKTAR_TEST        (ExDiffusion_2D_LFRDG_deformed_GAUSS)
    ADD_NEKTAR_TEST_LENGTHY(ExDiffusion_2D_LFRHU_deformed)
    ADD_NEKTAR_TEST_LENGTHY(ExDiffusion_2D_LFRHU_deformed_GAUSS)
    ADD_NEKTAR_TEST_LENGTHY(ExDiffusion_2D_LFRSD_deformed)
    ADD_NEKTAR_TEST_LENGTHY(ExDiffusion_2D_LFRSD_deformed_GAUSS)

    ADD_NEKTAR_TEST(Helmholtz1D_8modes_DG)
    ADD_NEKTAR_TEST(Helmholtz1D_8modes)
    ADD_NEKTAR_TEST(Helmholtz1D_8nodes)
    
    ADD_NEKTAR_TEST(SteadyAdvDiffReact2D_modal)
    ADD_NEKTAR_TEST(UnsteadyAdvectionDiffusion_3DHomo1D_MVM)
    ADD_NEKTAR_TEST(UnsteadyAdvectionDiffusion_3DHomo2D_MVM)
    ADD_NEKTAR_TEST(UnsteadyAdvectionDiffusion_Order1_0001)
    ADD_NEKTAR_TEST(UnsteadyAdvectionDiffusion_Order1_001)
    ADD_NEKTAR_TEST(UnsteadyAdvectionDiffusion_Order2_0001)
    ADD_NEKTAR_TEST(UnsteadyAdvectionDiffusion_Order2_001)
    ADD_NEKTAR_TEST(UnsteadyAdvection_WDG_3DHomo1D_MVM)
    ADD_NEKTAR_TEST(UnsteadyAdvection_FRDG_3DHomo1D_MVM)
    ADD_NEKTAR_TEST(UnsteadyAdvection_FRSD_3DHomo1D_MVM)
    ADD_NEKTAR_TEST(UnsteadyAdvection_FRHU_3DHomo1D_MVM)
    ADD_NEKTAR_TEST(UnsteadyDiffusion_LDG_3DHomo1D_MVM)
    ADD_NEKTAR_TEST(UnsteadyDiffusion_LFRDG_3DHomo1D_MVM)
    ADD_NEKTAR_TEST(UnsteadyDiffusion_LFRSD_3DHomo1D_MVM)
    ADD_NEKTAR_TEST(UnsteadyDiffusion_LFRHU_3DHomo1D_MVM)
    ADD_NEKTAR_TEST(UnsteadyAdvectionDiffusion_WeakDG_LDG_3DHomo1D_MVM)
    ADD_NEKTAR_TEST(UnsteadyAdvectionDiffusion_FRDG_LFRDG_3DHomo1D_MVM)
    ADD_NEKTAR_TEST(UnsteadyAdvectionDiffusion_FRSD_LFRSD_3DHomo1D_MVM)        	    
    ADD_NEKTAR_TEST(UnsteadyAdvectionDiffusion_FRHU_LFRHU_3DHomo1D_MVM)

    ADD_NEKTAR_TEST(Helmholtz2D_modal_DG)
    ADD_NEKTAR_TEST(Helmholtz2D_modal)
    ADD_NEKTAR_TEST(Helmholtz2D_nodal)
    ADD_NEKTAR_TEST(Helmholtz3D_nodal_HexDeformed)
    ADD_NEKTAR_TEST(Helmholtz_3DHomo1D_MVM)
    ADD_NEKTAR_TEST(Helmholtz_3DHomo2D_MVM)
    ADD_NEKTAR_TEST_LENGTHY(Helmholtz3D_modal)
    ADD_NEKTAR_TEST_LENGTHY(Helmholtz3D_nodal)
    ADD_NEKTAR_TEST(Helmholtz3D_CubePeriodic)
    ADD_NEKTAR_TEST(Helmholtz3D_Cube_BndFile)
    ADD_NEKTAR_TEST(Helmholtz3D_CubePeriodic_RotateFace)
    ADD_NEKTAR_TEST(ImDiffusion_m12)
    ADD_NEKTAR_TEST(ImDiffusion_m6)
    ADD_NEKTAR_TEST(ImDiffusion_VarCoeff)
    ADD_NEKTAR_TEST(ImDiffusion_Quad_Periodic_m7)
    ADD_NEKTAR_TEST(ImDiffusion_Hex_Periodic_m5)
    ADD_NEKTAR_TEST(SVV_Quad)
    ADD_NEKTAR_TEST(SVV_Tri)
    ADD_NEKTAR_TEST(SVV_Prism)
    ADD_NEKTAR_TEST(SVV_Tet)

    
    IF (NEKTAR_USE_FFTW)
        ADD_NEKTAR_TEST(Helmholtz_3DHomo1D_FFT)
        ADD_NEKTAR_TEST(Helmholtz_3DHomo2D_FFT)
        ADD_NEKTAR_TEST(UnsteadyAdvectionDiffusion_3DHomo1D_FFT)
        ADD_NEKTAR_TEST(UnsteadyAdvectionDiffusion_3DHomo2D_FFT)
	ADD_NEKTAR_TEST(UnsteadyAdvection_WDG_3DHomo1D_FFT)
        ADD_NEKTAR_TEST(UnsteadyAdvection_FRDG_3DHomo1D_FFT)
        ADD_NEKTAR_TEST(UnsteadyAdvection_FRSD_3DHomo1D_FFT)
        ADD_NEKTAR_TEST(UnsteadyAdvection_FRHU_3DHomo1D_FFT)
	ADD_NEKTAR_TEST(UnsteadyDiffusion_LDG_3DHomo1D_FFT)
        ADD_NEKTAR_TEST(UnsteadyDiffusion_LFRDG_3DHomo1D_FFT)
        ADD_NEKTAR_TEST(UnsteadyDiffusion_LFRSD_3DHomo1D_FFT)
        ADD_NEKTAR_TEST(UnsteadyDiffusion_LFRHU_3DHomo1D_FFT)
        ADD_NEKTAR_TEST(UnsteadyAdvectionDiffusion_WeakDG_LDG_3DHomo1D_FFT)
        ADD_NEKTAR_TEST(UnsteadyAdvectionDiffusion_FRDG_LFRDG_3DHomo1D_FFT)
        ADD_NEKTAR_TEST(UnsteadyAdvectionDiffusion_FRSD_LFRSD_3DHomo1D_FFT)
        ADD_NEKTAR_TEST(UnsteadyAdvectionDiffusion_FRHU_LFRHU_3DHomo1D_FFT)
    ENDIF (NEKTAR_USE_FFTW)

    IF (NEKTAR_USE_MPI)
        ADD_NEKTAR_TEST_LENGTHY(Advection3D_m12_DG_hex_par)
        ADD_NEKTAR_TEST_LENGTHY(Advection3D_m12_DG_prism_par)
        ADD_NEKTAR_TEST_LENGTHY(Advection3D_m12_DG_tet_par)
	ADD_NEKTAR_TEST_LENGTHY(Advection3D_m12_DG_hex_VarP_par)
	ADD_NEKTAR_TEST_LENGTHY(Advection3D_m12_DG_tet_VarP_par)
	ADD_NEKTAR_TEST_LENGTHY(Advection3D_m12_DG_prism_VarP_par)
        ADD_NEKTAR_TEST(Advection3D_m12_DG_hex_periodic_par)
        ADD_NEKTAR_TEST_LENGTHY(ImDiffusion_Quad_Periodic_m7_par)
        ADD_NEKTAR_TEST(ImDiffusion_Hex_Periodic_m5_par)
        ADD_NEKTAR_TEST(Helmholtz3D_CubePeriodic_par)
        ADD_NEKTAR_TEST(Helmholtz3D_CubeDirichlet_par)
        ADD_NEKTAR_TEST(Helmholtz3D_CubePeriodic_RotateFace_par)
    ENDIF (NEKTAR_USE_MPI)
ENDIF( NEKTAR_SOLVER_ADR )
